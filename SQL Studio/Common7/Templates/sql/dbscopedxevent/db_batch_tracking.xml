<event_sessions xmlns="http://schemas.microsoft.com/sqlserver/2008/07/extendedeventconfig">
  <event_session name="batch_all" maxMemory="4" eventRetentionMode="allowSingleEventLoss" trackCausality="true" dispatchLatency="30" maxEventSize="0" memoryPartitionMode="none">
    <templateCategory>
      <!-- _locID_text="templateCategory" _locComment = "" -->Abfrageausführung</templateCategory>
    <templateName>
      <!-- _locID_text = "templateName" _locComment = "" -->Abfragebatchnachverfolgung</templateName>
    <templateDescription>
      <!-- _locID_text = "templateDescription" _locComment = "" -->Diese Vorlage sammelt Anweisungen auf Batch- und RPC-Ebene sowie Fehlerinformationen. Mithilfe dieser Vorlage können Sie den Abfragefluss im System nachvollziehen und Fehler bis zu den Abfragen hin zurückverfolgen, von denen sie ausgelöst wurden. Alle Batchereignisse in dieser Sitzung werden gesammelt, sodass die Sammlung sehr groß werden kann. Um die Größe der Sammlung zu reduzieren, können Sie auch die Vorlage 'Abfragebatch-Stichprobe' verwenden, die bereits über einen Filter verfügt.</templateDescription>    
    <event package="sqlserver" name="error_reported">
      <action package="sqlserver" name="client_app_name"/>
      <action package="sqlserver" name="database_id"/>
      <action package="sqlserver" name="query_hash"/>
      <action package="sqlserver" name="session_id"/>
      <predicate>
        <and>
          <leaf>
            <comparator name="greater_than_uint64" package="package0"></comparator>
            <global name="database_id" package="sqlserver"></global>
            <value>4</value>
          </leaf>
          <leaf>
            <comparator name="equal_boolean" package="package0"></comparator>
            <global name="is_system" package="sqlserver"></global>
            <value>FALSE</value>
          </leaf>
        </and>
      </predicate>
    </event>
    <event package="sqlserver" name="rpc_completed">
      <action package="sqlserver" name="client_app_name"/>
      <action package="sqlserver" name="database_id"/>
      <action package="sqlserver" name="query_hash"/>
      <action package="sqlserver" name="session_id"/>
      <predicate>
        <and>
          <leaf>
            <comparator name="greater_than_uint64" package="package0"></comparator>
            <global name="database_id" package="sqlserver"></global>
            <value>4</value>
          </leaf>
          <leaf>
            <comparator name="equal_boolean" package="package0"></comparator>
            <global name="is_system" package="sqlserver"></global>
            <value>FALSE</value>
          </leaf>
        </and>
      </predicate>
    </event>
    <event package="sqlserver" name="sql_batch_completed">
      <action package="sqlserver" name="client_app_name"/>
      <action package="sqlserver" name="database_id"/>
      <action package="sqlserver" name="query_hash"/>
      <action package="sqlserver" name="session_id"/>
      <predicate>
        <and>
          <leaf>
            <comparator name="greater_than_uint64" package="package0"></comparator>
            <global name="database_id" package="sqlserver"></global>
            <value>4</value>
          </leaf>
          <leaf>
            <comparator name="equal_boolean" package="package0"></comparator>
            <global name="is_system" package="sqlserver"></global>
            <value>FALSE</value>
          </leaf>
        </and>
      </predicate>
    </event>
    <target package="package0" name="ring_buffer"/>
  </event_session>
</event_sessions>
